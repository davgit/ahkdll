<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>ahkdll</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../css/commands.css" rel="stylesheet" type="text/css">
<link href="../css/print.css" rel="stylesheet" type="text/css" media="print">
</head>
<body>

<h1>ahkdll() <span class="small65">[AutoHotkey.dll or AutoHotkey_NL30N7+]</span></h1>
<hr size="2">
<p>launches a script within AutoHotkey.dll</p>

<p class="CommandSyntax">hThread := DllCall("AutoHotkey.dll\ahkdll", "str", fileName, "str", argv, "str", args, "Cdecl Int")  </p>
<h4>Parameters</h4>
<table border="1" width="100%" cellspacing="0" cellpadding="3" bordercolor="#C0C0C0">
  <tr>
    <td width="15%">hThread</td>
    <td width="85%">ahkdll() returns the handle to the thread in which the dll script runs.</td>
  </tr>
  <tr>
    <td>filename</td>
    <td>name of script to be compiled and added to the running script</td>
  </tr>
  <tr>
    <td>argv</td>
    <td>options, the only one supported is "/Debug" for Lexikos' <a href="http://www.autohotkey.net/~Lexikos/AutoHotkey_L/docs/Debugging_Features.htm">Debugging Features</a></td>
  </tr>
  <tr>
<td>args</td>
    <td>script parameters: "%1% %2% %3%", see <a href="http://www.autohotkey.com/docs/Scripts.htm#cmd">ahk help file</a></td>
  </tr>
 </table>
<h4>Remarks</h4>
<br>its ahkdll, not addDll or other variation.  case is important for dllcall.<br>
when the client script exits, so does the host app automatically.
Use #persistent in the client script, if you want the host app to continue going.
<h4>Examples</h4>
<h3>Host Script</h3>
<pre class="NoIndent">
ahkdll := DllCall("LoadLibrary", "str", A_ScriptDir . "\AutoHotkey.dll")
sleep, 500
threadH := DllCall(A_ScriptDir . "\AutoHotkey.dll\ahkdll", "str", "dllclient.ahk", "str"
, "", "str", "parameter1 parameter2", "Cdecl Int") 
</pre>
<h3>Client Script</h3>
<pre class="NoIndent">
; dllclient.ahk
#Persistent
msgbox % "script parameters =" . A_ScriptParams . "script options = "
. A_ScriptOptions 
return
</pre>
</body>
</html>
